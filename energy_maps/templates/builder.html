{% extends 'base.html' %}

{% block main %}
  <div class="map wrapper">
    <div id="spinner" style="display: none;">
      <img id="spinner" src="../static/images/spinner.gif" alt="loading"/>
    </div>
    <div class="main map builder"></div>
    <div class="map composite"> </div>
    <!-- Layer divs -->
  </div>
  <!-- Map Builder UI -->
  <div class="options">
    <span>Create a custom map:</span>
    <br>

    <br>
    <button class="button clear">Clear</button>
  </div>
  <!--/ Map Builder UI -->
  <a id=download download=custom-map.png>
    <button type=button onClick=download()>Download</button>
  </a>
{% endblock %}

{% block bodyjs %}

  <script>
    let SCALE = {{ scale }};
  </script>

  {% assets 'js_d3' %}<script src="{{ ASSET_URL }}"></script>{% endassets %}
  <script src="https://unpkg.com/topojson-client@3"></script>
  {% assets 'js_bigfucker' %}<script src="{{ ASSET_URL }}"></script>{% endassets %}

  <script>

  function download() {
    let download = document.getElementById('download');
    let image = document.getElementById('mapcanvas')
      .toDataURL('image/png')
      .replace('image/png', 'image/octet-stream');
    download.setAttribute('href', image);
  }
  </script>

{% endblock %}
