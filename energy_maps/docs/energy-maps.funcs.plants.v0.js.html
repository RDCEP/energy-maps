<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: energy-maps.funcs.plants.v0.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: energy-maps.funcs.plants.v0.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Provides draw functions and any helpers for all power plants.
 * @author Benjamin Kleeman
 * @author Nathan Matteson
 * @module Plants
 */

 /**
 * A collection of power plant classifications used for filtering.
 * @type {Object} 
 * @property {Object} stroke - contains rgba and scale values to assign to ctx.strokeStyle 
 * @property {Number} scale - sets the scale of all plants to a multiple of global SCALE 
 * @property {Number} old_scale - clumsily retained legacy value of scale
 * @property {Object} identifier - an abbreviation of the class name in the data file, contains the following nested props:
 * @property {string} fuel_type - a nested property; cooresponds to class heading in data file 
 * @property {string} color - a nested property; corresponds to `viz` object; used to distinguish plant sets on screen 
 */

SCALE = 1;

let plant_stroke = 'rgba(255, 255, 255, 1)';
let electricity_generation = {
  stroke: {
    light: 'rgba(255, 255, 255, 1)',
    natural_gas: 'darkblue',
    sun: 'darkorange',
    dark: 'rgba(0, 0, 0, 1)', // TODO: Is this prop used anywhere?
    width: .66 * SCALE
  },
  scale: .3 * SCALE, //old_scale: .9 * SCALE, // TODO: figure out if needed
  coal_plants: {
    src: '',
    func: 0,
    dom_class_attribute: '',
    fuel_type: 'COAL',
    legend_func: 0,
    text: 'Coal power plant',
    color: 'rgba(0, 0, 0, .5)',
    stroke: plant_stroke
  },
  geo_plants: { 
    src: '',
    func: 0,
    dom_class_attribute: '',
    fuel_type: 'GEO',
    legend_func: 0,
    text: 'Geothermal power plant',
    color: 'rgba(210, 105, 30, .5)',
    stroke: plant_stroke
  },
  hyc_plants: {
    src: '',
    func: 0,
    dom_class_attribute: '',
    fuel_type: 'HYC',
    legend_func: 0,
    text: 'Hydro power plant',
    color: 'rgba(11, 36, 251, .5)',
    stroke: plant_stroke
  }, 
  ng_plants: {
    src: '',
    func: 0,
    dom_class_attribute: '',
    fuel_type: 'NG',
    legend_func: 0,
    text: 'Natural gas power plant',
    color: 'rgba(0, 191, 255, .5)',
    stroke: 'darkblue'
  }, 
  nuc_plants: {
    src: '',
    func: 0,
    dom_class_attribute: '',
    fuel_type: 'NUC',
    legend_func: 0,
    text: 'Nuclear power plant',
    color: 'rgba(255, 0, 0, .5)',
    stroke: plant_stroke
  }, 
  pet_plants: {
    src: '',
    func: 0,
    dom_class_attribute: '',
    fuel_type: 'PET',
    legend_func: 0,
    text: 'Petroleum power plant',
    color: 'rgba(34, 139, 34, .5)',
    stroke: plant_stroke
  }, 
  solar_plants: {
    src: '',
    func: 0,
    dom_class_attribute: '',
    fuel_type: 'SUN',
    legend_func: 0,
    text: 'Solar power plant',
    color: 'rgba(255, 215, 0, .5)',
    stroke: 'darkorange'
  },
  wnd_farms: {
    src: '',
    func: 0,
    dom_class_attribute: '',
    fuel_type: 'WND',
    legend_func: 0,
    text: 'Wind farm',
    color: 'rgba(144, 29, 143, .5)',
    stroke: plant_stroke
  },
}; 

/**
 * Helper function for draw_single_plant(). Draw the white background for each symbol.
 * @param {Object} plants - data from the readfile, passes through from draw_single_plant()
 * @param {Object} fuel - fuel object from `electricity_generation`, passes through from draw_single_plant()
 * @param {Object} ctx - HTML5 canvas context
 */
function draw_white_layer(plants, fuel, ctx) {
  features.forEach(function (d) {
    let xy = projection(d.geometry.coordinates);
    draw_power_plant(ctx, xy, viz.white, +d.properties.total_cap);
  });
}

/**
 * Draw a single set of power plants relative to their class.
 * @param {Object} ctx - HTML5 canvas context
 * @param {Object} queued_data - the readfile
 * @param {Object} fuel - fuel object from `electricity_generation`
 */
// TODO: Is this drawing one single plant, or one single set of plants? Change jsdoc if necessary
const draw_single_plant = function draw_single_plant(ctx, queued_data, fuel) {
  console.log('draw_single_plant');

  let plants = queued_data[0];

  features = plants.features
    .filter(function (d) {
      return d.properties.primary_fu === fuel.fuel_type;
    });

  draw_white_layer(plants, fuel, ctx);
  // Draw the standard layer
  features.forEach(function(d, i) {
    let xy = projection(d.geometry.coordinates);
    if (xy === null) {
      //
    } else {
      let color = fuel.color;
      draw_power_plant(ctx, xy, color, +d.properties.total_cap);
    }
    if (i === features.length - 1) { 
      hide_spinner(); 
    }
  });

};

// TODO: Determine purpose and add jsdoc
const draw_power_plant = function draw_power_plant(ctx, xy, color, r) {
  ctx.strokeStyle = electricity_generation.stroke.light;
  ctx.lineWidth = electricity_generation.stroke.width;
  ctx.fillStyle = color;
  // TODO: extract math to variable or function
  r = Math.sqrt(r / Math.PI) * electricity_generation.scale;
  ctx.beginPath();
  // Draw larger circle for stroke, so that stroke aligns to outside of
  //  of circumference
  draw_circle(ctx, xy, r + ctx.lineWidth);
  // FIXME: Need a better method of changing stroke color for lighter circles.
  if (color !== viz.white) {
    if (color === electricity_generation.ng_plants.color) {
      ctx.strokeStyle = 'darkblue';
    } else if (color === electricity_generation.solar_plants.color) {
      ctx.strokeStyle = 'darkorange';
    }
    ctx.stroke();
  }
  draw_circle(ctx, xy, r);
  ctx.fill();
};

const draw_coal_plants = function draw_coal_plants(ctx, queued_data) {
  draw_single_plant(ctx, queued_data, electricity_generation.coal_plants)
};

const draw_ng_plants = function draw_ng_plants(ctx, queued_data) {
  draw_single_plant(ctx, queued_data, electricity_generation.ng_plants)
};

const draw_petro_plants = function draw_petro_plants(ctx, queued_data) {
  draw_single_plant(ctx, queued_data, electricity_generation.pet_plants)
};

const draw_hydro_plants = function draw_hydro_plants(ctx, queued_data) {
  draw_single_plant(ctx, queued_data, electricity_generation.hyc_plants)
};

const draw_nuclear_plants = function draw_nuclear_plants(ctx, queued_data) {
  draw_single_plant(ctx, queued_data, electricity_generation.nuc_plants)
};

const draw_wind_farms = function draw_wind_farms(ctx, queued_data) {
  draw_single_plant(ctx, queued_data, electricity_generation.wnd_farms)
};

const draw_solar_plants = function draw_solar_plants(ctx, queued_data) {
  draw_single_plant(ctx, queued_data, electricity_generation.solar_plants)
};

const draw_geo_plants = function draw_geo_plants(ctx, queued_data) {
  draw_single_plant(ctx, queued_data, electricity_generation.geo_plants)
};


















// FIXME: MOVE TO A STATIC MAPS FUNCS DIR/FILE OR DELETE LATER
// UNTIL A DECISION IS MADE, THIS CODE IS SAFE TO IGNORE (COMMENT LEFT 01/15/2020)
// Old code, used for drawing the static images. Replace with code
// that just calls each function
const draw_power_plants = function draw_power_plants(ctx, queued_data, nff) {
  console.log('draw_power_plants');

  let plants = queued_data[0];

  // Toggle fuels for fossil vs non-fossil fuels
  let fuels = ['PET', 'NG', 'COAL'];
  if (nff) {
    fuels = ['SUN', 'WND', 'NUC', 'GEO', 'HYC'];
  }

  plants.features.filter(function(d) {
      return fuels.indexOf(d.properties.primary_fu) > -1;
    })
    .forEach(function(d) {
      let xy = projection(d.geometry.coordinates);
      draw_power_plant(ctx, xy, viz.white, +d.properties.total_cap);
    });
  plants.features
    .filter(function(d) {
      return fuels.indexOf(d.properties.primary_fu) > -1;
    }).forEach(function(d) {
      let xy = projection(d.geometry.coordinates);
      if (xy === null) {
        //
      } else {
        let color = fuel.color;
        draw_power_plant(ctx, xy, color, +d.properties.total_cap);
      }
    });
};

const draw_ff_plants = function draw_ff_plants(ctx, queued_data) {
  // draw_power_plants(ctx, queued_data, false) // old implementation
  // suggested implementation below:
  draw_petro_plants(ctx, queued_data);
  draw_ng_plants(ctx, queued_data);
  draw_coal_plants(ctx, queued_data);
};

const draw_nff_plants = function draw_nff_plants(ctx, queued_data) {
  // draw_power_plants(ctx, queued_data, true) old implementation
  // suggested implementation below:
  draw_solar_plants(ctx, queued_data);
  draw_wind_farms(ctx, queued_data);
  draw_nuclear_plants(ctx, queued_data);
  draw_geo_plants(ctx, queued_data);
  draw_hydro_plants(ctx, queued_data);
};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Coal.html">Coal</a></li><li><a href="module-Grid.html">Grid</a></li><li><a href="module-Legends.html">Legends</a></li><li><a href="module-Plants.html">Plants</a></li><li><a href="module-Wells.html">Wells</a></li></ul><h3>Namespaces</h3><ul><li><a href="Init.html">Init</a></li></ul><h3>Classes</h3><ul><li><a href="InfrastructureSet.html">InfrastructureSet</a></li><li><a href="module-Coal-Coal.html">Coal</a></li></ul><h3>Global</h3><ul><li><a href="global.html#canvas_width">canvas_width</a></li><li><a href="global.html#draw_box">draw_box</a></li><li><a href="global.html#draw_circle">draw_circle</a></li><li><a href="global.html#draw_cross">draw_cross</a></li><li><a href="global.html#draw_land">draw_land</a></li><li><a href="global.html#draw_polygon">draw_polygon</a></li><li><a href="global.html#draw_triangle">draw_triangle</a></li><li><a href="global.html#draw_triangle_down">draw_triangle_down</a></li><li><a href="global.html#draw_x">draw_x</a></li><li><a href="global.html#get_path">get_path</a></li><li><a href="global.html#height">height</a></li><li><a href="global.html#padding">padding</a></li><li><a href="global.html#path">path</a></li><li><a href="global.html#projection">projection</a></li><li><a href="global.html#viz">viz</a></li><li><a href="global.html#width">width</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Tue Feb 11 2020 15:21:22 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
